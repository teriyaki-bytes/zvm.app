---
---
<script is:inline id="posthog-js">
  // PostHog web snippet (self-hosted API domain)
  (function(t, e) {
    if (e.__SV) return;
    var o, n, p, r;
    (window.posthog = e),
      (e._i = []),
      (e.init = function(i, s, a) {
        function g(t, e) {
          var o = e.split('.');
          o.length === 2 && ((t = t[o[0]]), (e = o[1]));
          t[e] = function() {
            t.push([e].concat(Array.prototype.slice.call(arguments, 0)));
          };
        }
        ((p = t.createElement('script')).type = 'text/javascript'),
          (p.async = true),
          (p.crossOrigin = 'anonymous'),
          (p.src = s.api_host + '/static/array.js'),
          (r = t.getElementsByTagName('script')[0]).parentNode.insertBefore(p, r);
        var u = e;
        a !== undefined ? (u = e[a] = []) : (a = 'posthog');
        u.people = u.people || [];
        u.toString = function(t) {
          var e = 'posthog';
          return a !== 'posthog' && (e += '.' + a), t || (e += ' (stub)'), e;
        };
        u.people.toString = function() {
          return u.toString(1) + '.people (stub)';
        };
        o =
          'capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys getNextSurveyStep onSessionId'.split(
            ' '
          );
        for (n = 0; n < o.length; n++) g(u, o[n]);
        e._i.push([i, s, a]);
      }),
      (e.__SV = 1);
  })(document, window.posthog || []);
  posthog.init('phc_fstzp4N8YjAsDHA3cpuisuTDl103x9biDG7Hq9lXca4', {
    api_host: 'https://us.i.posthog.com',
    autocapture: true,
    capture_pageview: true,
    persistence: 'localStorage',
  });
</script>

<script is:inline id="posthog-events">
  (function() {
    function safeCapture(event, props) {
      try {
        if (window.posthog && typeof window.posthog.capture === 'function') {
          window.posthog.capture(event, props);
        }
      } catch (_) {
        /* fail silently */
      }
    }

    let listenerAttached = false;
    function attachListener() {
      if (listenerAttached) return;
      listenerAttached = true;
      document.addEventListener(
        'click',
        (evt) => {
          const target = evt.target.closest('[data-ph-event]');
          if (!target) return;
          const name = target.getAttribute('data-ph-event');
          const props = {
            href: target.getAttribute('href') || undefined,
            text: target.textContent?.trim().slice(0, 80) || undefined,
            id: target.id || undefined,
          };
          safeCapture(name, props);
        },
        true
      );
    }

    attachListener();
    document.addEventListener('astro:after-swap', attachListener);
  })();
</script>
